<!DOCTYPE html>
<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:tal="http://xml.zope.org/namespaces/tal"
        xmlns:metal="http://xml.zope.org/namespaces/metal"
        metal:define-macro="main"
        >

<head>
    <meta charset="utf-8"/>
    <title metal:define-slot="page-title">${view.title | request.sdiapi.sdi_title()}</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0"/>

    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Styles -->
    <!--! sdi_bootstrap.css includes bootstrap and sdi-specific css generated by LESS -->
    <link href="${request.static_url('substanced.sdi:static/css/sdi_bootstrap.css')}"
          rel="stylesheet"/>

    <!-- Fav icons -->
    <link rel="shortcut icon"
          href="${request.static_url('substanced.sdi:static/img/favicon.ico')}"/>

    <!-- Scripts -->
    <script src="${request.static_url('deform:static/scripts/jquery-1.7.2.min.js')}"
            type="text/javascript"></script>
    <script src="${request.static_url('substanced.sdi:static/js/bootstrap.js')}"
            type="text/javascript"></script>
    <script src="${request.static_url('substanced.sdi:static/js/sdi.js')}"
            type="text/javascript"></script>

    <more tal:omit-tag="" metal:define-slot="head-more"></more>

</head>

<body tal:define="home_path request.sdiapi.mgmt_path(request.virtual_root)">

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse"
               data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a tal:define="sdititle request.sdiapi.sdi_title()"
               class="brand"
               href="${home_path}"><img 
                    alt="${sdititle}"
                    src="${request.static_url('substanced.sdi:static/img/capsule-icon-32.png')}"
                    />${sdititle}</a>

            <div class="nav-collapse">
                <div class="nav pull-right">
                  <img id="sdi-loading-img" src="${request.static_url('substanced.sdi:static/img/progress_bar.gif')}"
                       style="display:none" alt="Loading indicator"/>
                    <div class="btn-group" tal:condition="request.user">
                        <a class="btn btn-primary"
                           href="${request.sdiapi.mgmt_path(request.user)}"><i
                                class="icon-user icon-white"></i>
                            ${request.user.__name__}</a>
                        <a class="btn btn-primary dropdown-toggle"
                           data-toggle="dropdown" href="#"><span
                                class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="${request.sdiapi.mgmt_path(request.user, '')}"><i
                                        class="icon-pencil"></i>
                                    Account</a></li>
                            <li>
                                <a href="${request.sdiapi.mgmt_path(request.root, '@@logout')}"><i
                                        class="icon-stop"></i> Log Out</a>
                            </li>
                        </ul>
                    </div>
                    <span class="navbar-text"
                          tal:condition="not request.user">Not logged in</span>
                </div>
            </div>
            <!--/.nav-collapse -->
        </div>
    </div>
</div>

<div class="container-fluid">

  <metal:slot metal:define-slot="outer-content">

    <ul class="breadcrumb"
        tal:define="breadcrumbs request.sdiapi.breadcrumbs()"
        tal:condition="breadcrumbs">
        <tal:breadcrumbs repeat="breadcrumb breadcrumbs">
            <li tal:attributes="class breadcrumb['active']">
                <i class="${breadcrumb['icon']}"> </i>
                <a href="${breadcrumb['url']}">${breadcrumb['name']}</a>
             <span tal:condition="not repeat.breadcrumb.end"
                   class="divider">/</span>
            </li>
        </tal:breadcrumbs>
    </ul>

    <div class="row-fluid">

        <div class="span12">

            <ul class="nav nav-tabs"
                tal:define="tabs request.sdiapi.mgmt_views(context)"
                tal:condition="tabs">
                <li tal:repeat="tab_data tabs"
                    tal:attributes="class tab_data['class']">
                    <a href="${tab_data['url']}">${tab_data['title']}</a>
                </li>
            </ul>

            <div class="above-content">
            </div>

            <div id="messages"
                 class="${request.is_xhr and 'ajax-replace' or ''}">
                <div tal:repeat="queue ('info', 'success', 'error', '')"
                     tal:omit-tag="">
                    <div class="alert alert-${queue}"
                         tal:define="messages request.session.pop_flash(queue)"
                         tal:condition="messages"
                         tal:repeat="message messages">
                      <button type="button" class="close" data-dismiss="alert">&times;</button>
                      ${structure:message}
                    </div>
                </div>
            </div>

            <div class="inner-content">
                <div metal:define-slot="main">
                </div>
            </div>

            <div class="below-content">
            </div>

        </div>

    </div>

  </metal:slot>

</div>

<more tal:omit-tag="" metal:define-slot="tail-more"></more>

</body>

</html>
